<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ç¿¼è£é£›è¡Œè¨“ç·´æ—¥èªŒ</title>
    <style>
      body {
        font-family: "Noto Sans TC", sans-serif;
        background: linear-gradient(to right, #ebe9b8, #edebaf, #edebad);
        color: #000;
        text-align: center;
        padding: 2em;
      }
      .container {
        max-width: 700px;
        margin: auto;
        background: rgba(255, 255, 255, 0.7);
        border-radius: 15px;
        padding: 2em;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      }
      h1 {
        font-size: 35px; /* å­—é«”å¤§å° */
        color: #ffffff; /* ç™½è‰²å­—é«”æ¯”è¼ƒé©åˆåšå…‰æšˆæ•ˆæœ */
        font-weight: bold; /* ç²—é«” */
        text-align: center; /* ç½®ä¸­ */
        margin-bottom: 30px; /* ä¸‹æ–¹ç•™ç©º */
        text-shadow:
          0 0 5px #c2a200,
          0 0 10px #c2a200,
          0 0 15px #c2a200,
          0 0 20px #c2a200;
        /*background-color: #000000;   /* å»ºè­°åŠ æ·±èƒŒæ™¯è®“å…‰æšˆæ›´æ˜é¡¯ */
        padding: 0px;
        border-radius: 10px;
      }
      h4 {
        font-size: 1.4em;
        line-height: 1.6;
        margin-bottom: 1em;
        color: #e3ce0e;
      }
      h5 {
        font-size: 1.2em;
        line-height: 1.2;
        margin-top: 0em;
        margin-bottom: 1em;
        color: #b3a102;
      }
      h6 {
        font-size: 1.3em;
        margin: 1em 0;
        text-align: justify;
        color: #e3ce0e;
        text-align: center;
      }
      .intro {
        text-align: left;
        margin-bottom: 0em;

        background: rgba(0, 0, 0, 0.05);
        padding: 0.5em;
        border-radius: 10px;
      }
      .hidden {
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
        position: absolute;
        left: -9999px; /* æŠŠå®ƒæŒªå‡ºç•«é¢å¤– */
      }


      .center {
        text-align: center;
      }
      button {
        margin: 1em;
        padding: 0.75em 2em;
        font-size: 1.2em;
        border-radius: 12px;
        border: none;
        cursor: pointer;
        background: #fcd303;
        color: black;
        transition: background 0.3s ease;
      }
      button:hover { background: #e6cc0a; }
      .choice-btn {
        display: block;
        margin: 1em auto;
        width: 90%;
        cursor: pointer;
      } 
      #question-title {
        font-size: 2em; /* ä½ å¯ä»¥ä¾éœ€æ±‚èª¿æ•´æ•¸å€¼ */
        font-weight: bold; /* ä¹Ÿå¯ä»¥è¨­ç‚º normal, lighter ç­‰ */
        margin-bottom: 0.5em;
        color: #e3ce0e;
      }
      #question-text {
        font-size: 1.5em;
        line-height: 1.6;
        margin-bottom: 1em;
      }
      #knowledge-text {
        font-size: 1.3em;
        line-height: 1.6;
        margin-bottom: 1em;
        text-align: justify;
      }
      .choice-button {
        display: block;
        margin: 10px auto;
        width: 80%;
      }
      .content {max-width: 600px; margin: auto; }
      .choice-btn {
        display: block;
        width: 100%;
        margin: 0.5em 0;
        padding: 1em;
        font-size: 1em;
      }
      #final-highlight {
        font-size: 1.5em;
        margin: 1em 0;
        font-weight: bold;
        text-align: center;
        background: linear-gradient(270deg, red, orange, yellow, green, blue, indigo, violet, red);
        background-size: 400% 400%;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        animation: rainbow 2s ease infinite;
      }
      
      .risk-notice {
        text-align: center;
        font-size: 1.5em;
        color: #e60039;
        margin-bottom: 1em;
        height: 1.5em; /* ä¿ç•™ç©ºé–“ï¼Œæ·¡å‡ºå¾Œä¸å½±éŸ¿ç‰ˆé¢è·³å‹• */
        transition: opacity 0.5s ease;
        opacity: 0;
      }

      #output {
        font-size: 1.2em;
        margin-top: 2em;
        padding: 1em;
        border: 1px solid #ccc;
        background: #f9f9f9;
        white-space: pre-line;
        text-align: justify;
      }
      @keyframes rainbow {
        0% { background-position: 100% 50%; }
        50% { background-position: 0% 50%; }
        100% { background-position: 100% 50%; }
      }
      
      #dice3d-container {
        perspective: 800px;
        text-align: center;
        margin: 2em auto;
        height: 150px;
      }

      .dice {
        width: 100px;
        height: 100px;
        position: relative;
        transform-style: preserve-3d;
        transform: rotateX(0deg) rotateY(0deg);
        transition: transform 1s ease;
        margin: auto;
      }

      .face {
        position: absolute;
        width: 100px;
        height: 100px;
        background: #fcd303;
        color: #000;
        font-size: 2em;
        font-weight: bold;
        line-height: 100px;
        text-align: center;
        border: 4px solid #b89c00;
        border-radius: 10px;
      }

      .front  { transform: translateZ(50px); }
      .back   { transform: rotateY(180deg) translateZ(50px); }
      .right  { transform: rotateY(90deg) translateZ(50px); }
      .left   { transform: rotateY(-90deg) translateZ(50px); }
      .top    { transform: rotateX(90deg) translateZ(50px); }
      .bottom { transform: rotateX(-90deg) translateZ(50px); }
      
      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }
      
      .game-intro {
        text-align: justify;
      }

    </style>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet">
  </head>
  <body>
    <div class="container">
      <!-- é¦–é  -->
      <div id="start-screen">
        <h1>ç¿¼è£é£›è¡Œè¨“ç·´æ—¥èªŒ</h1>
        <h4 class="center">è¸ä¸Šå¤©ç©ºä¹‹è·¯ï¼Œæ›¸å¯«å†’éšªç¯‡ç« ï¼</h4>
        <div class="intro">
          <h5>ç¿¼è£é£›è¡Œæ˜¯ä¸€é …çµåˆé€Ÿåº¦ã€æŠ€å·§èˆ‡é¢¨éšªçš„æ¥µé™é‹å‹•ã€‚ç«‹é«”åŠ‡å ´é›»å½±ã€Šç¿¼è£é£›è¡Œã€‹çš„å…§å®¹åŒ–ç‚ºé€™æ¬¾å°éŠæˆ²ï¼Œå°‡ä½ çš„æ—…ç¨‹å¯«å…¥ä¸€ç¯‡ç¨ä¸€ç„¡äºŒçš„è¨“ç·´æ—¥èªŒâ€”â€”</h5>
          <h5>è¦‹è­‰ä½ çš„å …æŒèˆ‡é£›è¡Œå¤¢æƒ³å§ï¼</h5>
          <div class="game-intro">
            <h3>ğŸ” éŠæˆ²èªªæ˜</h3> 
            <p>
              ğŸŒŒ <strong>èƒŒæ™¯æ•…äº‹</strong><br/>
              ä½ å°‡è¸ä¸Šå’Œä¸»è§’ç¾…è²å¡”ç›¸ä¼¼çš„é£›è¡Œæ—…ç¨‹ï¼Œé€éä¸€é€£ä¸²çš„é¸æ“‡é«”é©—é£›è¡Œè¨“ç·´ã€æŒ‘æˆ°æ¥µé™ã€‚åœ¨é€™æ®µè¨“ç·´æ—…é€”ä¸­ï¼Œä½ å°‡å­¸æœƒåˆ¤è®€å¤©æ°£ã€èª¿æ•´é£›è¡Œå§¿æ…‹ã€é¸æ“‡åˆé©è£å‚™ç­‰ç­‰ï¼Œä¸¦ç†è§£èƒŒå¾Œçš„ç‰©ç†çŸ¥è­˜ã€‚
            </p>
            <p>
              ğŸ§  <strong>ç©æ³•ç°¡ä»‹</strong><br/>
              éŠæˆ²ç¸½å…± 5 ç¨®æƒ…å¢ƒã€‚æ¯ç¨®æƒ…å¢ƒåªèƒ½é¸æ“‡ä¸€å€‹ç­”æ¡ˆã€‚é™¤äº†åœ°é»ä»¥å¤–ï¼Œæ¯ç¨®æƒ…å¢ƒçš„ä¸åŒé¸æ“‡éƒ½æœƒå¢åŠ ä¸åŒçš„é¢¨éšªï¼Œé¢¨éšªå€¼éé«˜å°±æœƒå°è‡´è©²æ¬¡é£›è¡Œå¤±æ•—å–”ï¼
            </p>
            <p>
              ğŸ† <strong>ç›®æ¨™èˆ‡çµå±€</strong><br/>
              éŠæˆ²çµæŸå¾Œï¼Œå°‡æ ¹æ“šä½ çš„é¸æ“‡ç²å¾—å°ˆå±¬çš„ç¿¼è£é£›è¡Œè¨“ç·´æ—¥èªŒã€‚
            </p>
          </div>
        </div>
		<p>è¨»ï¼šæœ¬éŠæˆ²ä»‹é¢è¨­è¨ˆä»¥æ‰‹æ©Ÿä½¿ç”¨è€…ç‚ºä¸»ï¼Œæ–¼é›»è…¦ç€è¦½æ™‚éƒ¨åˆ†å…§å®¹å¯èƒ½ç„¡æ³•å®Œæ•´é¡¯ç¤ºã€‚</p>
        <button onclick="startGame()">é–‹å§‹å‰µå»ºæˆ‘çš„æ—¥èªŒ</button>
      </div>

      <!-- å•é¡Œé é¢ -->
      <div id="question-screen" class="hidden">
        <h2 id="question-title"></h2>
        <p style="text-align: center" id="question-text"></p>
        <div id="question-options"></div>
        <!-- éª°å­ -->
        <div id="dice3d-container" class="hidden">
          <div class="dice" id="dice3d">
            <div class="face front">+0</div>
            <div class="face back">+10</div>
            <div class="face right">+2</div>
            <div class="face left">+1</div>
            <div class="face top">+0</div>
            <div class="face bottom">+1</div>
          </div>
        </div>

        <div id="risk-notice" class="risk-notice"></div>
      </div>
      <!-- çŸ¥è­˜é  -->
      <div class="hidden" id="knowledge-screen">
        <p id="knowledge-text"></p>
        <div id="info-link" class="hidden" style="margin-top: 1em"></div>
        <button onclick="nextQuestion()">ç¹¼çºŒ</button>
      </div>
      
      <!-- çµå°¾é  -->
      <div id="final-message-screen" class="hidden">
        <h6>å†’éšªå®¶æ‰¾åˆ°äº†è¨±å¤šå‰äººå°šæœªå˜—è©¦çš„è·¯ç·šï¼Œ<br>å°‡æˆ‘å€‘å¸¶åˆ°å¾æœªæœ‰äººåˆ°éçš„åœ°æ–¹ï¼Œ<br>å®Œæˆå¾æœªæœ‰äººåšéçš„äº‹æƒ…ã€‚</h6>
        <h2 id="final-highlight">é€™å°±æ˜¯å¤¢æƒ³â€”â€”<br>å°‹æ‰¾çµ‚æ¥µè·¯ç·šï¼Œä¸¦åœ¨æœ‰ç”Ÿä¹‹å¹´è¬›è¿°é€™å€‹æ•…äº‹ã€‚</h2>        
        <div id="FMinfo-link" class="hidden" style="margin-top: 1em;"></div>
        <button onclick="showOutput()">æŸ¥çœ‹æ—¥èªŒ</button>
      </div>

      <!-- è¼¸å‡ºé é¢ -->
      <div id="output-screen" class="hidden">
        <h2>ğŸŒŸ æˆ‘çš„è¨“ç·´æ—¥èªŒ</h2>
        <div id="risktotal"></div>
        <div id="output"></div>
        <button onclick="restartGame()">é‡æ–°é–‹å§‹</button>
        <!-- <button onclick="downloadJournal()">ä¸‹è¼‰æ—¥èªŒ</button>-->
      </div>
    </div>

    <script>
      const state = {
        step: 0,
        answers: {},
        fatal: false,
        journalParts: [],
        risk: 0,
        riskRecord: [], // å­˜æ¯é¡Œé¢¨éšªæ•¸å€¼
        hasFatalRisk: false, // æ˜¯å¦æœ‰ +10 é¡Œ
      }

      const locations = {
        A: "ç‘å£«ï¼šæ„›æ ¼çˆ¾å³°",
        B: "ç¾åœ‹ï¼šæ‘©æŠ¼æ²™æ¼ ",
        C: "æ¾³æ´²ï¼šå¸Œçˆ¾ç£ä¸Šç©º",
      }

      const weatherOptions = [
        { key: "A", label: "æ™´æœ—" },
        { key: "B", label: "æ°£å£“è®ŠåŒ–å¤§" },
        { key: "C", label: "èƒ½è¦‹åº¦ä½ï¼Œæœ‰å¼·é¢¨" },
        { key: "D", label: "èƒ½è¦‹åº¦é›¶" },
      ]

      const questions = [
        {
          key: "location",
          text: "é¸æ“‡ä½ çš„è¨“ç·´åœ°é»ï¼š",
          options: {
            A: locations.A,
            B: locations.B,
            C: locations.C,
          },
          knowledge: {
            A: "é˜¿çˆ¾å‘æ–¯å±±è„ˆçš„æ„›æ ¼çˆ¾å³°åˆç¨±æ­»äº¡ä¹‹ç‰†ï¼Œå¤©æ°£è®ŠåŒ–å¿«é€Ÿã€é›£ä»¥é æ¸¬ï¼Œæ˜¯æ­»äº¡ç‡æ¥µé«˜çš„é£›è¡Œå ´åŸŸï¼Œè¶…é 60 ä½å†’éšªå®¶å†ä¹Ÿæ²’æœ‰å›ä¾†ã€‚",
            B: `æ‘©æŠ¼æ²™æ¼ çš„å³­å£é›–ç„¶åªæœ‰æ„›æ ¼çˆ¾å³°çš„ä¸‰åˆ†ä¹‹ä¸€é«˜ï¼Œå»æ˜¯ç·´ç¿’ä½ç©ºç¿¼è£é£›è¡Œ(å¾æ‡¸å´–è€Œéé£›æ©Ÿä¸Šç¸±èº«èºä¸‹)çš„ç†æƒ³å ´åŸŸã€‚
            
            ç„¶è€Œï¼Œé«˜æº«ä½¿ç©ºæ°£å¯†åº¦è®Šä½ï¼Œè¼ƒé›£ç”¢ç”Ÿè¶³å¤ çš„å‡åŠ›ï¼Œä¹Ÿæ›´å®¹æ˜“ç”¢ç”Ÿäº‚æµèˆ‡å°æµã€‚
            
            é€™äº›æ¢ä»¶è®“é£›è¡Œæ›´å…·æŒ‘æˆ°æ€§ï¼Œä¹Ÿè€ƒé©—é£›è¡Œå“¡çš„åˆ¤æ–·èˆ‡å§¿å‹¢æ§åˆ¶èƒ½åŠ›ã€‚`,
            C: `å¸Œçˆ¾ç£çš„æµ·å²¸ç­†ç›´å»¶ä¼¸ï¼Œæ²™ç˜å¹³å¦å¯¬å»£ï¼Œæ˜¯å¤©ç„¶çš„é£›è¡Œè‘—é™¸è·‘é“ã€‚
            
            åœ¨é€™è£¡å¾é«˜ç©ºèºä¸‹ï¼Œä¸åƒ…èƒ½ä¿¯ç°å£¯éº—æµ·æ™¯ï¼Œæ›´èƒ½ç·´ç¿’é«˜ç©ºã€é•·è·é›¢èˆ‡é«˜é€Ÿæ»‘ç¿”é£›è¡Œã€‚
            
            ç›¸è¼ƒæ–¼å±±å€ï¼Œé€™è£¡çš„æ°£æµè¼ƒç©©å®šï¼Œæ˜¯è¨“ç·´å§¿å‹¢èª¿æ•´èˆ‡é¢¨é˜»æ§åˆ¶çš„ç†æƒ³ç’°å¢ƒã€‚`,
          },
        },
        
        {
          key: "flightplan",
          text: "é£›è¡Œå‰ï¼Œä½ æœƒæ€éº¼åšæº–å‚™ï¼Ÿ",
          options: {
            A: "è¦ªè‡ªèµ°åœ°å½¢ï¼Œæ¨™å‡ºå‚™ç”¨é™è½é»",
            B: "ç”¨åœ°åœ–èˆ‡é¢¨å‘åœ–æ¨¡æ“¬è·¯ç·š",
            C: "æ ¹æ“šç¶“é©—åè¦†æ¨¡æ“¬æ‡‰è®Šç‹€æ³"
          },
          knowledge: {
            A: `æ¯ä¸€æ¬¡ç¿¼è£é£›è¡ŒèƒŒå¾Œï¼Œéƒ½æ˜¯å¤šé€±çš„è¦åŠƒèˆ‡æº–å‚™ã€‚é£›è¡Œè€…éœ€è¦ªè‡ªè¸æŸ¥åœ°å½¢ã€ç¢ºèªæ½›åœ¨éšœç¤™èˆ‡å®‰å…¨è‘—é™¸é»ã€‚
            
            è¨±å¤šè·¯ç·šéœ€åœ¨é«˜æµ·æ‹”åœ°å€é•·æ™‚é–“æ­¥è¡Œæ‰èƒ½å®Œæˆæ¢æŸ¥ï¼Œé¢¨å‘ã€æ°£å£“èˆ‡åœ°å½¢äº¤æœƒé»éƒ½å¯èƒ½æ˜¯é—œéµé¢¨éšªã€‚
            
            é æ¸¬ã€æ¨¡æ“¬ã€æ“¬å®šå‚™æ¡ˆï¼Œæ‰èƒ½è®“çŸ­çŸ­å¹¾åˆ†é˜çš„é£›è¡Œæ›´åŠ å®‰å…¨ã€å®Œæ•´ã€‚`,
            B: `æ¯ä¸€æ¬¡ç¿¼è£é£›è¡ŒèƒŒå¾Œï¼Œéƒ½æ˜¯å¤šé€±çš„è¦åŠƒèˆ‡æº–å‚™ã€‚é£›è¡Œè€…éœ€è¦ªè‡ªè¸æŸ¥åœ°å½¢ã€ç¢ºèªæ½›åœ¨éšœç¤™èˆ‡å®‰å…¨è‘—é™¸é»ã€‚
            
            è¨±å¤šè·¯ç·šéœ€åœ¨é«˜æµ·æ‹”åœ°å€é•·æ™‚é–“æ­¥è¡Œæ‰èƒ½å®Œæˆæ¢æŸ¥ï¼Œé¢¨å‘ã€æ°£å£“èˆ‡åœ°å½¢äº¤æœƒé»éƒ½å¯èƒ½æ˜¯é—œéµé¢¨éšªã€‚
            
            é æ¸¬ã€æ¨¡æ“¬ã€æ“¬å®šå‚™æ¡ˆï¼Œæ‰èƒ½è®“çŸ­çŸ­å¹¾åˆ†é˜çš„é£›è¡Œæ›´åŠ å®‰å…¨ã€å®Œæ•´ã€‚`,
            C: `æ¯ä¸€æ¬¡ç¿¼è£é£›è¡ŒèƒŒå¾Œï¼Œéƒ½æ˜¯å¤šé€±çš„è¦åŠƒèˆ‡æº–å‚™ã€‚é£›è¡Œè€…éœ€è¦ªè‡ªè¸æŸ¥åœ°å½¢ã€ç¢ºèªæ½›åœ¨éšœç¤™èˆ‡å®‰å…¨è‘—é™¸é»ã€‚
            
            è¨±å¤šè·¯ç·šéœ€åœ¨é«˜æµ·æ‹”åœ°å€é•·æ™‚é–“æ­¥è¡Œæ‰èƒ½å®Œæˆæ¢æŸ¥ï¼Œé¢¨å‘ã€æ°£å£“èˆ‡åœ°å½¢äº¤æœƒé»éƒ½å¯èƒ½æ˜¯é—œéµé¢¨éšªã€‚
            
            é æ¸¬ã€æ¨¡æ“¬ã€æ“¬å®šå‚™æ¡ˆï¼Œæ‰èƒ½è®“çŸ­çŸ­å¹¾åˆ†é˜çš„é£›è¡Œæ›´åŠ å®‰å…¨ã€å®Œæ•´ã€‚`
          }
        },

        {
          key: "weather",
          question: "ä½ è¦åœ¨é€™ç¨®å¤©æ°£ä¸‹é€²è¡Œé£›è¡Œå—ï¼Ÿ",
          isWeather: true,
        },
        {
          key: "training",
          text: "ä»Šå¤©ä½ è¦å°ˆæ³¨çš„è¨“ç·´ç›®æ¨™æ˜¯ï¼Ÿ",
          options: {
            A: "æå‡å‡åŠ›",
            B: "ç·¨éšŠé£›è¡Œ",
            C: "é«˜ç©ºåŠ é€Ÿèˆ‡æ¸›é€Ÿ",
          },
          knowledge: {
            A: `èª¿æ•´é£›è¡Œå§¿å‹¢èˆ‡å‚¾æ–œè§’åº¦å¯ä»¥æœ€å¤§åŒ–å‡åŠ›ï¼Œé€²è€Œæå‡æ»‘ç¿”è·é›¢ã€‚
            
            å‡åŠ›ä¾†è‡ªç©ºæ°£åœ¨é£›ç¿¼ä¸Šä¸‹ç”¢ç”Ÿçš„å£“åŠ›å·®ï¼Œèˆ‡é£›è¡Œé¢ç©å’Œå§¿å‹¢æœ‰é—œã€‚
            
            è‰¯å¥½çš„å§¿æ…‹å¯é”åˆ°ç´„ 3:1 çš„æ»‘ç¿”æ¯”ï¼Œè®“ä½ æ¯ä¸‹é™ 1 å…¬å°ºå°±èƒ½æ»‘ç¿” 3 å…¬å°ºä»¥ä¸Šã€‚`,
            B: `ç·¨éšŠé£›è¡Œéœ€è¦é£›è¡Œè€…ä¹‹é–“é«˜åº¦çš„é»˜å¥‘èˆ‡è·é›¢æ§åˆ¶ã€‚æ¯ä½é£›è¡Œè€…åœ¨ç©ºä¸­é£›è¡Œæ™‚ï¼Œèº«å¾Œæœƒç”¢ç”Ÿä¸€æ®µä¸å¯è¦‹ã€æ··äº‚çš„æ°£æµï¼Œç¨±ç‚ºå°¾è·¡æ¹æµã€‚
            
            è‹¥ä¸å°å¿ƒé€²å…¥é€™äº›æ¹æµå€åŸŸï¼Œé£›é¼ è£å¯èƒ½æœƒæ‘ºç–Šã€å¤±é€Ÿï¼Œç”šè‡³å¢œè½ã€‚å®‰å…¨çš„é£›è¡Œä½ç½®é€šå¸¸æ˜¯æ–œä¸‹æ–¹æˆ–å´å¾Œæ–¹ï¼Œé¿å…æ­£å¾Œæ–¹ï¼Œæ‰èƒ½æœ‰æ•ˆé¿é–‹å°¾è·¡ã€‚
            
            æ¹æµé™¤äº†ä¾†è‡ªå‰æ–¹é£›è¡Œè€…ï¼Œä¹Ÿå¯èƒ½å› é¢¨èˆ‡åœ°å½¢äº¤äº’ä½œç”¨è€Œå½¢æˆã€‚é¢¨é€Ÿæ„ˆå¼·ã€é¢¨å‘è®ŠåŒ–æ„ˆåŠ‡çƒˆï¼Œæ¹æµå°±æ„ˆé›£é æ¸¬ï¼Œå› æ­¤éšŠå½¢èˆ‡é£›è¡Œç­–ç•¥çš„é¸æ“‡è‡³é—œé‡è¦ã€‚`,
            C: `é«˜ç©ºè·³å‚˜åˆæœŸé€Ÿåº¦è¿…é€Ÿä¸Šå‡ï¼Œåœ¨é‡åŠ›åŠ é€Ÿåº¦ä½œç”¨ä¸‹ï¼Œåƒ… 3 ç§’å…§æ™‚é€Ÿå°±å¯é”åˆ° 60 è‹±é‡Œï¼Œ8 ç§’å¾Œçªç ´ 100 è‹±é‡Œã€‚ç´„ 15 ç§’å¾Œï¼Œç”±æ–¼ç©ºæ°£é˜»åŠ›èˆ‡é‡åŠ›é”æˆå¹³è¡¡ï¼Œé€Ÿåº¦ç©©å®šæ–¼çµ‚ç«¯é€Ÿåº¦ã€‚
            
            é£›è¡Œè€…å¯é€éèª¿æ•´èº«é«”å‚¾æ–œè§’èˆ‡æ‰‹è…³é–‹å±•ç¨‹åº¦ï¼Œæ§åˆ¶ç©ºæ°£é˜»åŠ›ï¼Œé”åˆ°æé€Ÿæˆ–æ¸›é€Ÿçš„æ•ˆæœã€‚è¿‘å¹´è¨˜éŒ„é¡¯ç¤ºï¼Œæ¥µç«¯å§¿å‹¢ä¸‹çš„çµ‚ç«¯é€Ÿåº¦ç”šè‡³å¯çªç ´æ¯å°æ™‚ 250 è‹±é‡Œã€‚
            
            ç•¶æ‹‰é–‹é™è½å‚˜æ™‚ï¼Œæ™‚é€Ÿå°‡ç¬é–“é©Ÿé™è‡³ 10 è‹±é‡Œï¼Œå¦‚åŒç©ºä¸­æ€¥ç…è»Šã€‚é€™ä¸€éç¨‹è€ƒé©—é£›è¡Œè€…å°æ™‚æ©Ÿèˆ‡å§¿å‹¢çš„æº–ç¢ºæŒæ¡ï¼Œæ˜¯é£›è¡Œè¨“ç·´ä¸­æœ€å…·é¢¨éšªèˆ‡æŠ€è¡“æ€§çš„é …ç›®ä¹‹ä¸€ã€‚`,
          },
        },
        {
          key: "gear",
          text: "ä½ é¸æ“‡çš„é£›é¼ è£è£å‚™æ˜¯ï¼Ÿ",
          options: {
            A: "å‚³çµ±å°¼é¾é£›é¼ è£",
            B: "ç¢³çº–ç¶­æ°£å®¤è£"           
          },
          knowledge: {
            A: `å‚³çµ±é£›é¼ è£æœ€æ—©åªæ˜¯å°‡å°¼é¾å¸ƒæ–™ç¸«åœ¨è†è“‹èˆ‡æ‰‹è‡‚ä¹‹é–“ï¼Œæ§‹é€ ç°¡å–®ã€è¼•å·§ï¼Œä¸»è¦ç”¨æ–¼æ»‘ç¿”æŠ€å·§çš„åˆæ­¥è¨“ç·´ã€‚
            
            å®ƒæ²’æœ‰å…§å»ºæ°£å®¤æˆ–çµæ§‹å¼·åŒ–ï¼Œæ‰€æœ‰å‡åŠ›èˆ‡ç©©å®šæ€§éƒ½ä»°è³´é£›è¡Œè€…è‡ªèº«çš„å§¿å‹¢æ§åˆ¶èˆ‡å¼µåŠ›ç¶­æŒã€‚
            
            é›–ç„¶é˜»åŠ›è¼ƒå¤§ã€æ»‘ç¿”è·é›¢æœ‰é™ï¼Œä½†èƒ½æœ‰æ•ˆå¹«åŠ©é£›è¡Œè€…ç†è§£å‡åŠ›åŸç†ã€ç†Ÿæ‚‰ç©ºä¸­å§¿å‹¢ï¼Œæ˜¯ç´¯ç©ç¶“é©—çš„ç†æƒ³èµ·é»ã€‚`,
            B: `æ–°å‹é£›é¼ è£çµåˆæ°£å®¤çµæ§‹èˆ‡ç¢³çº–ç¶­å…§è¥¯ï¼Œèƒ½åœ¨è·³èºå¾Œè¿…é€Ÿå……æ°£è†¨è„¹ï¼Œåƒæ»‘ç¿”ç¿¼ä¸€æ¨£å½¢æˆå‰›æ€§çµæ§‹ã€‚é€™ä½¿é£›é¼ è£æ›´å¿«ç”¢ç”Ÿå‡åŠ›ï¼Œç¸®çŸ­å‚ç›´ä¸‹å¢œæ®µï¼Œææ—©é€²å…¥æ»‘ç¿”ç‹€æ…‹ã€‚
            
            é€²æ°£å£æ˜¯é—œéµè¨­è¨ˆï¼Œå®ƒå°å…¥æ°£æµè®“æ•´ä»¶è£å‚™å……æ°£æ’é–‹ï¼Œä½¿è£å‚™ç©©å®šå¦‚æ©Ÿç¿¼ï¼Œä¸¦æå‡æ•´é«”æŠ—é¢¨èƒ½åŠ›ã€‚
            
            æ°£å®¤è£å‚™èˆ‡ç¢³çº–ç¶­çš„çµåˆè®“é£›è¡Œæ›´ç©©å®šã€æ›´æœ‰æ•ˆç‡ï¼Œä¹Ÿè®“é£›è¡Œè€…èƒ½æŒ‘æˆ°éå»é›£ä»¥æŠµé”çš„å€åŸŸï¼Œæ˜¯ç¾ä»Šæœ€ä¸»æµçš„ç¿¼è£é¡å‹ã€‚`            
          },
        },
      ];

      function formatknowledge(knowledge) {
        return knowledge
          .replace(/\n/g, "<br>") // è‹¥ä½  intro è£¡æ˜¯ç”¨æ›è¡Œç¬¦è™Ÿæ–·è¡Œï¼Œä¹Ÿå¯ä»¥åŠ é€™è¡Œ
          .replace(/\s{2,}/g, ""); // æ¸…é™¤å¤šé¤˜ç©ºç™½
      }

      function startGame() {
        document.getElementById("start-screen").classList.add("hidden");
        state.step = 0;
        state.answers = {};
        state.fatal = false;
        state.journalParts = [];
        showQuestion();
      }

      function showQuestion() {
        const step = state.step;
        const q = questions[step];        
        document.getElementById("question-screen").classList.remove("hidden");
        document.getElementById("question-title").textContent = q.text;
        document.getElementById("question-text").textContent = q.question;

        
        const qOptBox = document.getElementById("question-options");
        qOptBox.innerHTML = "";
        if (q.isWeather) {
          const randomWeather =
                weatherOptions[Math.floor(Math.random() * weatherOptions.length)];
          state.currentWeather = randomWeather;

          document.getElementById("question-title").textContent = `ä»Šå¤©çš„å¤©æ°£æ˜¯ï¼š${randomWeather.label}`;

          const yesBtn = document.createElement("button");
          yesBtn.textContent = "æ˜¯çš„ï¼Œé–‹å§‹é£›è¡Œï¼";
          yesBtn.className = "choice-btn";
          yesBtn.onclick = () => {
            state.answers[q.key] = randomWeather.key
            if (randomWeather.key === "D") state.fatal = true
            applyRiskValue(q.key, randomWeather.key);
          };
          qOptBox.appendChild(yesBtn);

          const noBtn = document.createElement("button");
          noBtn.textContent = "æ“‡æ—¥å†æˆ°ï¼Œæ›å€‹å¤©æ°£å§";
          noBtn.className = "choice-btn";
          noBtn.onclick = () => showQuestion();
          qOptBox.appendChild(noBtn);
          return;
        }

        Object.entries(q.options).forEach(([key, label]) => {
          const btn = document.createElement("button");
          btn.textContent = label;
          btn.className = "choice-btn";
          btn.onclick = () => {
            state.answers[q.key] = key;
            
            if (q.key === "location") {
              // ç¬¬ä¸€é¡Œä¸è™•ç†é¢¨éšªï¼Œç›´æ¥é€²çŸ¥è­˜é 
              renderKnowledgePage(q, key);
            } else {
              applyRiskValue(q.key, key);
            }
          };
          qOptBox.appendChild(btn);
        });
      }
      
      function getRiskValue(qKey, selectedKey) {
        if (qKey === "weather" && selectedKey === "D") return 10;
        /*if (qKey === "flightplan" ) return 10;
        if (qKey === "weather" ) return 10;      
        if (qKey === "training" ) return 10;*/
        //if (qKey === "gear" ) return 10;

        const roll = Math.random();
        if (roll < 0.05) return 10;
        if (roll < 0.2) return 2;
        if (roll < 0.45) return 1;
        return 0;
      }

      function applyRiskValue(qKey, selectedKey) {
        const risk = getRiskValue(qKey, selectedKey);
        state.risk += risk;
        state.riskRecord.push(risk);
        if (risk === 10 && !(state.riskRecord.every(v => v === 2))) {
          state.hasFatalRisk = true;
        }

        // é¡¯ç¤º "+X" æç¤ºå¾Œä¾é¡Œç›®æ±ºå®šè·³å“ªå€‹å‡½å¼
        const afterRisk = () => {
          if (qKey === "weather") {
            nextQuestion();
          } else {
            renderKnowledgePage(questions[state.step], selectedKey);
          }
        };

        showRiskNotice(risk, afterRisk);
      }

      function renderKnowledgePage(question, selectedKey) {
        document.getElementById("question-screen").classList.add("hidden");
        document.getElementById("knowledge-screen").classList.remove("hidden");

        document.getElementById("knowledge-text").innerHTML = formatknowledge(question.knowledge[selectedKey]);

        const step = state.step;
        const info = questions[step];
        const link = info && info.link;
        const linkArea = document.getElementById("info-link");
        if (link) {
          linkArea.innerHTML = "<p>ç›¸é—œå…§å®¹</p>";

          // æƒ…æ³ 1ï¼šå¤šå€‹ç¶²å€
          if (Array.isArray(link)) {
            link.forEach((l) => {
              linkArea.innerHTML += `<a href="${l.url}" target="_blank" style="display:block; color:#00ccff;">${l.text}</a>`
            });
          }
          // æƒ…æ³ 2ï¼šå–®ä¸€ç¶²å€
          else if (link.url && link.text) {
            linkArea.innerHTML += `<a href="${link.url}" target="_blank" style="display:block; color:#00ccff;">${link.text}</a>`;
          }

          linkArea.classList.remove("hidden");
        } else {
          linkArea.innerHTML = "";
          linkArea.classList.add("hidden");
        }
      }

      function nextQuestion() {
        document.getElementById("knowledge-screen").classList.add("hidden");
        state.step++;
        if (state.step < questions.length) {
          showQuestion();
        } else {
          showFM();
        }
      }
      
      function showFM() {
        document.getElementById("final-message-screen").classList.remove("hidden");
        /*const linkArea = document.getElementById("FMinfo-link");
      	const link = [
          { text: "BBC Newsï¼šè®“äººè®Šèº«æˆã€Œé£›é¼ ã€çš„ç¿¼è£é£›è¡Œ", url: "https://www.bbc.com/ukchina/trad/vert_fut/2016/11/161104_vert_fut_the-man-who-wants-to-jump-out-of-a-plane-in-a-wingsuit"},
          { text: "åœ‹å®¶åœ°ç†é›œèªŒï¼šå®šé»è·³å‚˜å†å‚³æ­»äº¡æ„å¤–ï¼ˆä¸Šï¼‰", url: "https://www.natgeomedia.com/environment/article/content-3429.html"},
          { text: "åœ‹å®¶åœ°ç†é›œèªŒï¼šå®šé»è·³å‚˜å†å‚³æ­»äº¡æ„å¤–ï¼ˆä¸‹ï¼‰", url: "https://www.natgeomedia.com/explore/article/content-3330.html"}
        ]        
        if (link) {
          linkArea.innerHTML = "<p>å»¶ä¼¸å…§å®¹</p>";

          if (Array.isArray(link)) {
            link.forEach((l) => {
              linkArea.innerHTML += `<a href="${l.url}" target="_blank" style="display:block; color:#00ccff;">${l.text}</a>`
            });
          }
          linkArea.classList.remove("hidden");
        }*/
      }

      function showOutput() {
      	document.getElementById("final-message-screen").classList.add("hidden");
        document.getElementById("output-screen").classList.remove("hidden");
        
        function getRiskLabel(risk) {
        	const fatalIndex = state.riskRecord.findIndex(r => r === 10);
          const weatherIndex = 1; // å¤©æ°£æ˜¯riskRecord[1]

          // å¦‚æœé¸äº†èƒ½è¦‹åº¦ç‚ºé›¶ï¼Œä¸”é€™ä¸€é¡Œæ²’æœ‰è¢«å‰é¢çš„ +10 æ“‹ä½ï¼Œæ‰è‡´å‘½
          if (
            state.answers.weather === "D" &&
            (fatalIndex === -1 || fatalIndex >= weatherIndex)
          ) {
            return "è‡´å‘½";
          } else if (risk <= 2) {
            return "å®‰å…¨";
          } else if (risk <= 4) {
            return "ä½é¢¨éšª";
          } else if (risk <= 7) {
            return "é«˜é¢¨éšª";
          } else {
            return "å±éšª";
          }
          
        }
        const risktotalEl = document.getElementById("risktotal");
        risktotalEl.innerText = `ç¸½é¢¨éšªå€¼ï¼š${state.risk} (${getRiskLabel(state.risk)})`;

        const outputEl = document.getElementById("output");
        outputEl.innerText = "";
        const lines = [];

				// ç¬¬ä¸€å¥
        const introLines = [
          "ä»Šå¤©æ˜¯å€‹é‡è¦çš„æ—¥å­ï¼Œæˆ‘é–‹å§‹äº†ç¿¼è£é£›è¡Œçš„è¨“ç·´ä¹‹æ—…ã€‚",
          "ç«™åœ¨èµ·é£›é»ï¼Œæˆ‘çŸ¥é“é€™å°‡æ˜¯æ”¹è®Šæˆ‘çš„é£›è¡Œäººç”Ÿçš„ä¸€å¤©ã€‚",
          "ç¶“éé•·æ™‚é–“æº–å‚™ï¼Œæˆ‘çµ‚æ–¼è¸ä¸Šç¿¼è£é£›è¡Œçš„è¨“ç·´å¾é€”ã€‚"
        ];
        lines.push(randomFrom(introLines));
        
        // ç¬¬ä¸€é¡Œï¼šåœ°é»
        if (state.answers.location === "A") {
          lines.push(randomFrom([
            "æˆ‘ä¾†åˆ°å£¯éº—çš„æ„›æ ¼çˆ¾å³°ï¼Œé€™è£¡è¢«ç¨±ç‚ºæ­»äº¡ä¹‹ç‰†ï¼Œæ˜¯ç„¡æ•¸å†’éšªè€…å¤¢æƒ³çš„æŒ‘æˆ°åœ°é»ã€‚",
            "é˜¿çˆ¾å‘æ–¯å±±çš„æ„›æ ¼çˆ¾å³°æ°£å€™è®ŠåŒ–æ¥µå¿«ï¼Œè¨“ç·´æ™‚éœ€æ ¼å¤–è­¦è¦ºæ¯ä¸€å€‹é¢¨çš„è¨Šè™Ÿã€‚",
            "äº‹å‰èµ°éæ‰€æœ‰è·¯ç·šï¼Œè®“æˆ‘åœ¨é£›è¡Œæ™‚æ›´èƒ½å°ˆæ³¨æ–¼æŠ€å·§ï¼Œè€Œéæ“”æ†‚æœªçŸ¥ã€‚"
          ]));
        }
        if (state.answers.location === "B") {
          lines.push(randomFrom([
            "æˆ‘é¸æ“‡äº†æ‘©æŠ¼æ²™æ¼ ï¼Œåœ¨ç‚™ç†±æ‡¸å´–é–“é€²è¡Œæ‡¸å´–èµ·è·³èˆ‡è²¼åœ°é£›è¡Œè¨“ç·´ã€‚",
            "å„˜ç®¡é€™è£¡é«˜åº¦ä¸å¦‚é˜¿çˆ¾å‘æ–¯å±±ï¼Œä½†å³­å£åœ°å½¢èˆ‡ç†±ç©ºæ°£å¸¶ä¾†ç¨ç‰¹æŒ‘æˆ°ã€‚",
            "é«˜æº«ä½¿å‡åŠ›é›£ä»¥æŒæ¡ï¼Œæ¯ä¸€æ¬¡èµ·è·³éƒ½ä»°è³´æ¥µé«˜çš„åˆ¤æ–·åŠ›èˆ‡åæ‡‰é€Ÿåº¦ã€‚"
          ]));
        }
        if (state.answers.location === "C") {
          lines.push(randomFrom([
            "æˆ‘ä¾†åˆ°æ¾³æ´²çš„å¸Œçˆ¾ç£ï¼Œå¾é«˜ç©ºä¿¯ç°ç­†ç›´æµ·å²¸èˆ‡å£¯éº—æµ·æ™¯ï¼Œä»¤äººéœ‡æ’¼ã€‚",
            "é€™è£¡çš„æ°£æµç©©å®šï¼Œæ˜¯ç†æƒ³çš„é«˜ç©ºæ»‘ç¿”èˆ‡é¢¨é˜»æ§åˆ¶è¨“ç·´å ´ã€‚",
            "å¯¬å»£çš„æ²™ç˜æˆç‚ºå®Œç¾è‘—é™¸å ´ï¼Œä¹Ÿè®“æˆ‘æ›´å®‰å¿ƒåœ°ç·´ç¿’é«˜é€Ÿé•·è·é›¢é£›è¡Œã€‚"
          ]));
        }
        // ç¬¬äºŒé¡Œï¼šæº–å‚™
        const flightplanSentences = {
          A: { // è¦ªè‡ªèµ°åœ°å½¢ï¼Œæ¨™å‡ºå‚™ç”¨é™è½é»
            0: [
              "æˆ‘èŠ±äº†å¥½å¹¾å¤©è¦ªè‡ªè¸æŸ¥é£›è¡Œåœ°å½¢ï¼Œæ¨™å‡ºæ¯ä¸€å€‹å¯èƒ½çš„å‚™ç”¨é™è½é»ã€‚",
              "æˆ‘è¦ªè‡ªèµ°éè¨“ç·´åœ°å€ï¼Œç†Ÿæ‚‰æ¯ä¸€è™•åœ°å½¢èˆ‡å¯èƒ½å½±éŸ¿é£›è¡Œçš„æ°£æµã€‚",
              "æå‰æ¢æŸ¥æ‰€æœ‰è·¯ç·šï¼Œè®“æˆ‘èƒ½æŠŠæ³¨æ„åŠ›æ”¾åœ¨é£›è¡Œæœ¬èº«ï¼Œè€Œä¸æ˜¯è‡¨å ´æ‘¸ç´¢ã€‚"
            ],
            1: [
              "è·¯ç·šè¦åŠƒæ™‚å¿½ç•¥ä¸€è™•éš±è”½å¡é¢ï¼Œå¯¦åœ°æ¢æŸ¥æ™‚ç™¼ç¾é¢¨å‹¢ä¸ç©©ï¼Œæˆ‘æ”¹ç”¨å¦ä¸€å€‹é¢¨å‘è¼ƒé †çš„å€åŸŸä½œç‚ºé™è½é»ã€‚",
              "åœ°åœ–ä¸Šæ¨™è¨˜çš„æ›¿ä»£é™è½å€å¯¦éš›å¡åº¦å¤ªé™¡ï¼Œæˆ‘ç¾å ´é‡æ–°å°‹æ‰¾é–‹é—Šåœ°ä¸¦æ›´æ–°è¨“ç·´è¨ˆç•«ã€‚",
              "æˆ‘åˆæœŸéåº¦ä¾è³´åœ°åœ–æ•¸æ“šï¼ŒéŒ¯ä¼°è½é»å®‰å…¨æ€§ï¼Œæ‰€å¹¸ææ—©æŠµé”ç¾å ´è¦ªæ¸¬é¢¨å‘ï¼Œé †åˆ©æ‰¾åˆ°åˆé©è½é»ã€‚"
            ],
            2: [
              "æˆ‘ä½ä¼°æŸåœ°å½¢è½å·®ï¼Œç™¼ç¾é å®šé™è½é»éæ–¼å±éšªï¼Œå¯¦åœ°å¤šæ¬¡æ¯”å°é¢¨å‘èˆ‡åœ°å½¢å¾Œï¼Œæ”¹é¸è¼ƒå®‰å…¨å€åŸŸé™è½ã€‚",
              "æˆ‘ç™¼ç¾å¯¦éš›é¢¨å ´èˆ‡é æ¸¬å·®ç•°å¤ªå¤§ï¼ŒåŸæœ¬é£›è¡Œè·¯ç·šæœƒç©¿è¶Šäº‚æµï¼Œæˆ‘é‡æ–°è¦åŠƒé£›è¡Œæ–¹å‘é¿é–‹å±éšªå€åŸŸã€‚",
              "æˆ‘èª¤ä»¥ç‚ºæŸè™•é–‹é—Šåœ°èƒ½å®‰å…¨é™è½ï¼Œå¯¦åœ°æ¸¬é¢¨æ‰ç™¼ç¾äº‚æµæ¥µå¼·ï¼Œç«‹åˆ»æ›´æ›é™è½è¨ˆç•«é¿é–‹è©²å€ã€‚"
            ],
            10: [
              "æˆ‘èª¤åˆ¤äº†ä¸€è™•åœ°å½¢ç‚ºå¯ç”¨é™è½é»ï¼Œå¯¦éš›é£›è¡Œæ™‚æ‰ç™¼ç¾é¢¨å‹¢ä¸ç©©ã€éšœç¤™é‡é‡ï¼Œæœ€å¾Œåªèƒ½ç·Šæ€¥é–‹å‚˜ï¼Œä¸­æ­¢ä»»å‹™ã€‚é€™æ¬¡è¨“ç·´ï¼Œä»¥å¤±æ•—å‘Šçµ‚â€¦â€¦"
            ]
          },

          B: { // ç”¨åœ°åœ–èˆ‡é¢¨å‘åœ–æ¨¡æ“¬è·¯ç·š
            0: [
              "æˆ‘ä»”ç´°æ¯”å°å¤©æ°£é å ±ã€é¢¨å‘åœ–èˆ‡åœ°å½¢åœ–ï¼Œæ¨¡æ“¬äº†å¤šæ¢é£›è¡Œè·¯ç·šã€‚",
              "çµåˆæ•¸æ“šèˆ‡é æ¸¬å·¥å…·ï¼Œæˆ‘è¦åŠƒå‡ºä¸€æ¢é¿é–‹å¼·é¢¨èˆ‡äº‚æµçš„å®‰å…¨èˆªç·šã€‚",
              "é€éæ¨¡æ“¬å·¥å…·ï¼Œæˆ‘èƒ½é åˆ¤å¯èƒ½å‡ºç¾çš„é¢¨å ´è®ŠåŒ–èˆ‡éšœç¤™ç‰©åˆ†å¸ƒã€‚"
            ],
            1: [
              "é›–ç„¶è³‡æ–™é½Šå…¨ï¼Œä½†é å ±èª¤å·®å°è‡´æˆ‘éŒ¯ä¼°äº†æŸæ®µé¢¨é€Ÿè®ŠåŒ–ã€‚æ‰€å¹¸ç•¶ä¸‹ç«‹åˆ»èª¿æ•´è·¯ç·šï¼Œé¿é–‹äº†é¢¨å ´ã€‚",
              "æ¨¡æ“¬è»Œè·¡èˆ‡å¯¦éš›ç‹€æ³ç•¥æœ‰å‡ºå…¥ï¼Œæ‰€å¹¸æˆ‘åŠæ™‚èª¿æ•´ã€‚",
              "å·¥å…·æä¾›äº†æ–¹å‘ï¼Œä½†æŸäº›åœ°å½¢å¹²æ“¾ä»è®“æˆ‘æªæ‰‹ä¸åŠï¼Œæˆ‘è‡¨å ´æ”¹è®Šå§¿æ…‹æ§åˆ¶ï¼ŒæˆåŠŸç©©å®šé£›è¡Œã€‚"
            ],
            2: [
              "æˆ‘å°é¢¨é€Ÿåœ–çš„è§£è®€å¤±æº–ï¼Œé€²å…¥äº‚æµå€å¹¾ä¹å¤±æ§ï¼Œæ‰€å¹¸è‡¨æ™‚è®Šæ›´å§¿æ…‹ï¼Œæ‰å‹‰å¼·ç©©ä½äº†é£›è¡Œè»Œé“ã€‚",
              "æ¨¡æ“¬çµæœæœªæ¶µè“‹çªç™¼å¤©æ°£è®ŠåŒ–ï¼Œè®“æˆ‘æªæ‰‹ä¸åŠï¼Œä¸€åº¦åé›¢èˆªé“ï¼Œæœ€å¾Œå‹‰å¼·å›æ­£è·¯ç·šå®Œæˆè¨“ç·´ã€‚",
              "è³‡æ–™é›–å®Œæ•´ï¼Œä½†åˆ¤è®€éŒ¯èª¤è®“æˆ‘éŒ¯ä¼°äº†é¢¨å ´ï¼Œé£›è¡Œä¸­æ•¸æ¬¡åç§»ï¼Œåªèƒ½é ç¶“é©—å‹‰å¼·ä¿®æ­£è·¯å¾‘ã€‚"
            ],
            10: [
              "æˆ‘å°æ•¸æ“šä¾è³´éé‡ï¼Œå»å¿½ç•¥ç¾å ´é¢¨å‘è®Šç•°ï¼Œé£›è¡Œä¸­è¢«çªé¢¨æ²åè»Œé“ï¼Œæœ€çµ‚åªèƒ½æå‰é–‹å‚˜ï¼ŒçµæŸè¨“ç·´ã€‚é€™æ¬¡ä»»å‹™ï¼Œä»¥å¤±æ•—å‘Šçµ‚â€¦â€¦"
            ]
          },

          C: { // æ ¹æ“šç¶“é©—åè¦†æ¨¡æ“¬æ‡‰è®Šç‹€æ³
            0: [
              "æˆ‘æ ¹æ“šéå¾€ç¶“é©—åˆ¶å®šå¤šå¥—æ‡‰è®Šç­–ç•¥ï¼Œç¢ºä¿æ¯å€‹çªç™¼ç‹€æ³éƒ½èƒ½æ‡‰å°ã€‚",
              "é€™æ¬¡çš„è¨ˆç•«åŒ…å«äº†ä¸‰ç¨®å‚™ç”¨é£›è¡Œæ–¹æ¡ˆï¼Œè®“æˆ‘åœ¨ç©ºä¸­æ›´å¾å®¹ä¸è¿«ã€‚",
              "æˆ‘ç”¨è…¦ä¸­æ¨¡æ“¬é£›è¡Œå¤šæ¬¡ï¼Œæ¯ä¸€å€‹è½‰æŠ˜é»éƒ½é å…ˆå®‰æ’äº†æ‡‰è®Šé¸é …ã€‚"
            ],
            1: [
              "æˆ‘é åˆ¤çš„å¤§æ°£æµè½‰æŠ˜é»ææ—©å‡ºç¾ï¼Œå·®é»åé›¢èˆªç·šï¼Œæ‰€å¹¸ç¶“é©—è®“æˆ‘å³æ™‚åæ‡‰å›ç©©ã€‚",
              "åŸæœ¬çš„æ‡‰è®Šç­–ç•¥ç•¥é¡¯éæ–¼ç†æƒ³ï¼Œå¹¾æ¬¡è½‰å½è™•ä»å‡ºç¾é¢¨å ´åå·®ï¼Œæˆ‘æˆåŠŸé ç›´è¦ºé‡æ–°èª¿æ•´é£›è¡Œå§¿å‹¢ã€‚",
              "æŸæ®µè·¯ç·šå‡ºç¾æ„æ–™ä¹‹å¤–çš„å´é¢¨ï¼Œè®“æˆ‘å¹¾åº¦åç§»ï¼Œå¥½åœ¨ææ—©å‚™å¦¥äº†æ‡‰è®Šå‹•ä½œã€‚"
            ],
            2: [
              "æˆ‘èª¤åˆ¤äº†ä¸€æ®µå±±è°·é¢¨å ´çš„æ–¹å‘ï¼Œé£›è¡Œä¸­å¤šæ¬¡å¤±é€Ÿï¼Œåªèƒ½å’¬ç‰™èª¿æ•´å§¿å‹¢å‹‰å¼·æ’ä½ã€‚",
              "æ‡‰è®Šç­–ç•¥è¨­æƒ³ä¸å¤ å®Œæ•´ï¼Œçªå¦‚å…¶ä¾†çš„äº‚æµè®“æˆ‘ä¸€åº¦å¤±æ§ï¼Œé æœ€å¾Œä¸€åˆ»æ€¥è½‰æ‰é¿é–‹å±éšªå€åŸŸã€‚",
              "äº‚æµçš„å‡ºç¾æ‰“äº‚åŸå®šç­–ç•¥ï¼Œæˆ‘é æ€¥è½‰èˆ‡æ”¶è‚¢é«”ç©©ä½å§¿æ…‹ï¼Œå‹‰å¼·é€šéé‚£æ®µç©ºåŸŸã€‚"
            ],
            10: [
              "æˆ‘éåº¦ä»°è³´ç¶“é©—ï¼Œå»å¿½ç•¥ç¾å ´çœŸå¯¦ç‹€æ³ï¼Œè®“è¨“ç·´é™·å…¥æ··äº‚ï¼Œæœ€å¾Œåªèƒ½ææ—©é–‹å‚˜ä¸­æ­¢è¨“ç·´ã€‚é€™æ¬¡ä»»å‹™ï¼Œä»¥å¤±æ•—å‘Šçµ‚â€¦â€¦"
            ]
          }
        };

        const planKey = state.answers.flightplan;
        const planRisk = state.riskRecord[0]; // ç¬¬äºŒé¡Œé¢¨éšªå€¼
        lines.push(randomFrom(flightplanSentences[planKey][planRisk]));
        
				// ç¬¬ä¸‰é¡Œï¼šå¤©æ°£
        const weatherSentences = {
          A: { // æ™´æœ—
            0: [
              "å¤©æ°£æ™´æœ—ï¼Œæ°£æµç©©å®šï¼Œè®“æˆ‘æ›´å°ˆæ³¨æ–¼æŠ€è¡“çš„æå‡ã€‚",
              "é™½å…‰æ™®ç…§ï¼Œåœ°å½¢æ¸…æ™°å¯è¦‹ï¼Œæ˜¯ç†æƒ³çš„é£›è¡Œè¨“ç·´æ—¥ã€‚",
              "ç©©å®šçš„å¤©æ°£è®“æˆ‘å¾—ä»¥å°ˆæ³¨æ–¼æ¯ä¸€å€‹é£›è¡Œç´°ç¯€çš„å„ªåŒ–ã€‚"
            ],
            1: [
              "é›–ç„¶å¤©æ°£æ™´æœ—ï¼Œä½†é£›è¡Œé€”ä¸­çªæœ‰ä¸ç©©æ°£æµå‡ºç¾ï¼Œæˆ‘è‡¨æ™‚æ”¶è‚¢é«”èª¿æ•´å§¿å‹¢æ‰ç©©ä½æ–¹å‘ã€‚",
              "æ°£è±¡é æ¸¬é›–è‰¯å¥½ï¼Œå¯¦éš›é£›è¡Œä¸­ä»é­é‡äº›å¾®å´é¢¨ï¼Œåªèƒ½æŒçºŒå¾®èª¿é£›è¡Œè§’åº¦æ‡‰å°ã€‚",
              "æ•´é«”æ™´æœ—ä¸­å¤¾é›œä¸€è‚¡ä¸Šå‡äº‚æµï¼Œå¹²æ“¾äº†æ»‘ç¿”è·¯ç·šï¼Œæˆ‘å‹‰å¼·æ§åˆ¶å§¿æ…‹ç©©å®šé£›è¡Œã€‚"
            ],
            2: [
              "å¤©æ°£é å ±é¡¯ç¤ºæ™´æœ—ï¼Œå¯¦éš›é£›è¡Œæ™‚å»å‡ºç¾é€£çºŒäº‚æµï¼Œæˆ‘å¤šæ¬¡åç§»èˆªç·šï¼Œåªèƒ½ä¸æ–·ä¿®æ­£å§¿æ…‹ã€‚",
              "åŸä»¥ç‚ºé¢¨å ´ç©©å®šï¼Œå»é‡ä¸Šçªç™¼å¼·é¢¨å°è‡´æ»‘ç¿”åŠ‡çƒˆæ™ƒå‹•ï¼Œé è‡¨å ´ç¶“é©—æ‰æœªå¤±æ§ã€‚",
              "æ™´æœ—å¤©æ°£ä¸‹çªèµ·ç†±æ°£å°æµï¼Œä½¿æˆ‘é™·å…¥ä¸æ–·ä¸Šå‡èˆ‡ä¸‹æ²‰çš„äº‚æµå€ï¼Œåªèƒ½å‹‰å¼·ä¿æŒé£›è¡Œã€‚"
            ],
            10: [
              "å¤©æ°£é›–æ™´æœ—ç„¡é›²ï¼Œä½†æˆ‘ä¸€æ™‚åˆ†å¿ƒï¼Œæ²’æ³¨æ„åˆ°ä¸€éš»é³¥æ­£è¡å…¥é£›è¡Œè·¯ç·šã€‚é–ƒé¿ä¸åŠä¸‹ï¼Œé£›é¼ è£å´ç¿¼è¢«æ’è£‚ï¼Œæˆ‘åªèƒ½æå‰é–‹å‚˜ä¸­æ­¢è¨“ç·´ã€‚é€™æ¬¡ä»»å‹™ï¼Œä»¥å¤±æ•—å‘Šçµ‚â€¦â€¦"
            ]
          },
          B: { // æ°£å£“è®ŠåŒ–é »ç¹
            0: [
              "æ°£å£“è®ŠåŒ–é »ç¹ï¼Œæˆ‘å¿…é ˆæ™‚åˆ»èª¿æ•´å§¿æ…‹ä¾†æ‡‰å°é¢¨å‹¢ã€‚",
              "ä¸ç©©å®šçš„å¤©æ°£è¿«ä½¿æˆ‘æ›´éˆæ´»åœ°ä¿®æ­£é£›è¡Œè»Œè·¡ã€‚",
              "ä»Šå¤©çš„æ°£æµè¤‡é›œï¼Œæ˜¯è§€å¯Ÿèˆ‡å¯¦ä½œå§¿å‹¢æ§åˆ¶çš„å¥½æ™‚æ©Ÿã€‚"
            ],
            1: [
              "æ°£å£“ç•¥æœ‰æ³¢å‹•ï¼Œæˆ‘éœ€è¦ä¸æ–·å¾®èª¿é£›è¡Œå§¿å‹¢ä»¥ç¶­æŒç©©å®šæ»‘ç¿”ã€‚",
              "éƒ¨åˆ†æ°£å±¤å‡ºç¾å£“åŠ›ä¸ç©©ï¼Œæˆ‘æé«˜å°ˆæ³¨åŠ›è§€å¯Ÿé¢¨å‘è®ŠåŒ–ï¼Œå³æ™‚ä¿®æ­£é£›è¡Œæ–¹å‘ã€‚",
              "å£“åŠ›å·®é€ æˆçŸ­æš«äº‚æµï¼Œæˆ‘ä¾é æ…£æ€§èˆ‡å±•ç¿¼æ§åˆ¶ç©©ä½é£›è¡Œã€‚"
            ],
            2: [
              "æ°£å£“è®Šå‹•åŠ‡çƒˆï¼Œå°è‡´æ»‘ç¿”è·¯å¾‘ä¸ç©©ï¼Œæˆ‘åªèƒ½åè¦†ä¿®æ­£è»Œè·¡ï¼Œå¹¾åº¦å·®é»æ’ä¸Šå±±å£ã€‚",
              "é«˜ç©ºå£“åŠ›å¿½å‡å¿½é™ï¼Œé£›è¡Œé€Ÿåº¦è®ŠåŒ–é›£ä»¥é æ¸¬ï¼Œè®“æˆ‘å¹¾ä¹å¤±å»æ§åˆ¶ã€‚",
              "åŠ‡çƒˆæ°£å£“å·®è®“æ»‘ç¿”é›£ä»¥æŒçºŒï¼Œæˆ‘åªèƒ½é æŒçºŒä¿®æ­£å§¿æ…‹é¿å…å¤±é€Ÿã€‚"
            ],
            10: [
              "åŠ‡çƒˆæ°£å£“è®ŠåŒ–å°è‡´æˆ‘ä¸€åº¦å¤±é€Ÿå¢œè½ï¼Œæƒ…æ³å¤±æ§ä¹‹ä¸‹åªèƒ½ç·Šæ€¥çµæŸé£›è¡Œä»»å‹™ã€‚é€™æ¬¡ä»»å‹™ï¼Œä»¥å¤±æ•—å‘Šçµ‚â€¦â€¦"
            ]
          },
          C: { // å¼·é¢¨èˆ‡ä½èƒ½è¦‹åº¦
            0: [
              "å¼·é¢¨èˆ‡ä½èƒ½è¦‹åº¦å¢æ·»è¨“ç·´é›£åº¦ï¼Œä¹Ÿç£¨ç·´äº†æˆ‘çš„æ‡‰è®Šèƒ½åŠ›ã€‚",
              "åœ¨é¢¨å‹¢è®ŠåŒ–åŠ‡çƒˆçš„æƒ…æ³ä¸‹ï¼Œæˆ‘æ›´å°ˆæ³¨æ–¼æ¯ä¸€å€‹ç´°ç¯€çš„æ§åˆ¶ã€‚",
              "æƒ¡åŠ£å¤©æ°£ä¸‹çš„é£›è¡Œæ˜¯ä¸€å ´æ„å¿—èˆ‡æŠ€å·§çš„é›™é‡è€ƒé©—ã€‚"
            ],
            1: [
              "èƒ½è¦‹åº¦è¼ƒä½ï¼Œéƒ¨åˆ†åœ°å½¢ç„¡æ³•å³æ™‚åˆ¤æ–·ï¼Œæˆ‘æ”¾æ…¢é€Ÿåº¦ä¸¦æé«˜è­¦è¦ºæ‡‰å°çªç™¼é¢¨å‹¢ã€‚",
              "å¼·é¢¨æŒçºŒå¹è¥²ï¼Œä½¿æˆ‘é£›è¡Œæ™‚æ–æ™ƒä¸æ­¢ï¼Œé å°å¹…èª¿æ•´æ‰ä¿æŒæ»‘ç¿”ã€‚",
              "æ°£æµæ™‚å¼·æ™‚å¼±ï¼Œæˆ‘å¿…é ˆå…¨ç¥è²«æ³¨èª¿æ•´é£›è¡Œè§’åº¦ï¼Œä»¥é¿å…è¢«å´é¢¨å¸¶åã€‚"
            ],
            2: [
              "å¼·é¢¨å’Œä½èƒ½è¦‹åº¦åŒæ™‚ä¾†è¥²ï¼Œæˆ‘å¤šæ¬¡çœ‹ä¸æ¸…è·¯ç·šï¼Œè¢«è¿«æ”¹è®Šé£›è¡Œè»Œè·¡æ‰èƒ½é¿é–‹åœ°å½¢ã€‚",
              "æ¿ƒéœ§é®è”½è¦–é‡ï¼Œå¼·é¢¨å¾å±±è°·è¥²ä¾†ï¼Œæˆ‘åƒ…æ†‘é¢¨è²èˆ‡ç›´è¦ºå‹‰å¼·ç¶­æŒå¹³è¡¡ã€‚",
              "é£›è¡Œé€”ä¸­èƒ½è¦‹åº¦é©Ÿé™ï¼Œäº‚æµçªè¥²å°è‡´å§¿å‹¢å¤±æ§ï¼Œæˆ‘åœ¨ç©ºä¸­åŠ‡çƒˆæ–æ™ƒæ•¸æ¬¡æ‰å›ç©©ã€‚"
            ],
            10: [
              "æ¿ƒéœ§èˆ‡å¼·é¢¨åŒæ™‚è¥²ä¾†ï¼Œè¦–é‡å…¨å¤±ï¼Œæˆ‘ç„¡æ³•ç¢ºèªé£›è¡Œä½ç½®ï¼Œåªèƒ½ä¸­æ­¢ä»»å‹™ä»¥ç­–å®‰å…¨ã€‚é€™æ¬¡ä»»å‹™ï¼Œä»¥å¤±æ•—å‘Šçµ‚â€¦â€¦"
            ]
          },
          D: { // èƒ½è¦‹åº¦ç‚ºé›¶ â†’ å›ºå®š +10 çµå°¾
            A: { 10: "ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘åœ¨èƒ½è¦‹åº¦ç‚ºé›¶çš„æƒ…æ³ä¸‹èµ·é£›ï¼Œæœ€çµ‚è¿·å¤±åœ¨èŒ«èŒ«çš„å¤§é›ªèˆ‡é¢¨æš´ä¹‹ä¸­â€¦â€¦é€™æ¬¡ä»»å‹™ï¼Œä»¥æ²‰é»˜å‘Šçµ‚ã€‚"},
            B: { 10: "ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘åœ¨èƒ½è¦‹åº¦ç‚ºé›¶çš„æƒ…æ³ä¸‹èµ·é£›ï¼Œæœ€çµ‚è¿·å¤±åœ¨æ»¾æ»¾é»ƒæ²™èˆ‡æ²™å¡µæš´ä¹‹ä¸­â€¦â€¦é€™æ¬¡ä»»å‹™ï¼Œä»¥æ²‰é»˜å‘Šçµ‚ã€‚"},
            C: { 10: "ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘åœ¨èƒ½è¦‹åº¦ç‚ºé›¶çš„æƒ…æ³ä¸‹èµ·é£›ï¼Œæœ€çµ‚è¿·å¤±åœ¨çŒ›çƒˆæš´é¢¨é›¨çš„å¸­æ²ä¹‹ä¸­â€¦â€¦é€™æ¬¡ä»»å‹™ï¼Œä»¥æ²‰é»˜å‘Šçµ‚ã€‚"}
          }
        };

        const weatherKey = state.answers.weather;
        const weatherRisk = state.riskRecord[1]; // ç¬¬ä¸‰é¡Œé¢¨éšªå€¼
        if (weatherKey === "D") {
          const location = state.answers.location;
          lines.push(weatherSentences.D[location][weatherRisk]);
        } else {
          lines.push(randomFrom(weatherSentences[weatherKey][weatherRisk]));
        }
        
        // ç¬¬å››é¡Œï¼šè¨“ç·´ç›®æ¨™
        const trainingSentences = {
          A: { // æå‡å‡åŠ›
            0: [
              "æˆ‘å°ˆæ³¨æ–¼æå‡å‡åŠ›çš„è¨“ç·´ï¼Œé€éè§’åº¦èˆ‡å§¿å‹¢çš„èª¿æ•´ä¾†å¢åŠ æ»‘ç¿”è·é›¢ã€‚",
              "æˆ‘åè¦†ç·´ç¿’èº«é«”å‚¾æ–œèˆ‡å±•ç¿¼å§¿å‹¢ï¼Œè©¦åœ–å»¶é•·é£›è¡Œæ™‚é–“ã€‚",
              "å‡åŠ›è¨“ç·´è®“æˆ‘æ›´åŠ ç†è§£ç©ºæ°£æµå‹•èˆ‡èº«é«”è§’åº¦ä¹‹é–“çš„å¾®å¦™é—œä¿‚ã€‚"
            ],
            1: [
              "å§¿å‹¢ç•¥æœ‰èª¤å·®ï¼Œå°è‡´å‡åŠ›æ¸›å¼±ï¼Œé£›è¡Œè·é›¢ä¸å¦‚é æœŸï¼Œå¹¸å¥½å³æ™‚ä¿®æ­£æ”¹å–„è§’åº¦ã€‚",
              "å±•ç¿¼è§’åº¦ç•¥åï¼Œå°è‡´éŒ¯éæœ€ä½³å‡åŠ›å€ï¼Œæˆ‘ç«‹åˆ»èª¿æ•´è‚¢é«”å¼µåŠ›é¿å…å¤±é€Ÿã€‚",
              "èµ·é£›æ™‚æœªå®Œå…¨å±•é–‹é›™è‡‚ï¼ŒåˆæœŸå‡åŠ›ä¸è¶³ï¼Œé èº«é«”æ“ºå‹•æ‰ç©©ä½æ»‘ç¿”ã€‚"
            ],
            2: [
              "åœ¨è½‰æ›å§¿å‹¢æ™‚æœªèƒ½æœ‰æ•ˆå±•ç¿¼ï¼Œå¤±å»éƒ¨åˆ†å‡åŠ›ï¼Œä¸€åº¦ä¸‹å¢œï¼Œé è‡¨å ´åæ‡‰æ‰å‹‰å¼·å›ç©©é£›è¡Œã€‚",
              "å‡åŠ›è§’åº¦æŒæ¡éŒ¯èª¤ï¼Œå°è‡´é£›è¡Œé€”ä¸­å¤§å¹…æ–æ™ƒï¼Œåªèƒ½ä¸åœä¿®æ­£è§’åº¦ä»¥ç¶­æŒè·¯ç·šã€‚",
              "æˆ‘èª¤å°‡äº‚æµå€èª¤èªç‚ºå‡åŠ›è·¯ç·šï¼Œå°è‡´ä¸€è·¯ä¸‹æ»‘ï¼Œé ä¸æ–·èª¿æ•´è§’åº¦æ‰å‹‰å¼·å»¶é•·æ»‘ç¿”è·é›¢ã€‚"
            ],
            10: ["æˆ‘èª¤åˆ¤å‡åŠ›è§’åº¦éåº¦å‰å‚¾ï¼Œå§‹çµ‚ç„¡æ³•å±•é–‹æ»‘ç¿”å§¿å‹¢ï¼Œä¸å¾—å·²åªèƒ½ç·Šæ€¥é–‹å‚˜ä¸­æ­¢è¨“ç·´ã€‚é€™æ¬¡ä»»å‹™ï¼Œä»¥å¤±æ•—å‘Šçµ‚â€¦â€¦"]
          },

          B: { // ç·¨éšŠé£›è¡Œ
            0: [
              "æˆ‘é€²è¡Œäº†ç·¨éšŠé£›è¡Œè¨“ç·´ï¼Œèˆ‡å¤¥ä¼´ä¿æŒè‰¯å¥½è·é›¢ï¼Œé¿å…æ¹æµå¹²æ“¾ã€‚",
              "é€éè§€å¯Ÿå¤¥ä¼´çš„å‹•ä½œï¼Œæˆ‘å­¸æœƒäº†å³æ™‚å¾®èª¿è‡ªå·±çš„é£›è¡Œå§¿æ…‹ã€‚",
              "ç·¨éšŠé£›è¡Œä¸åƒ…éœ€è¦æŠ€è¡“ï¼Œä¹Ÿéœ€è¦çµ•å°çš„å°ˆæ³¨èˆ‡é»˜å¥‘ã€‚"
            ],
            1: [
              "èˆ‡å¤¥ä¼´çš„è·é›¢ç•¥è¿‘ï¼Œé€²å…¥å°æ–¹å°¾æµå€åŸŸç”¢ç”Ÿè¼•å¾®æ–æ™ƒï¼Œä½†æˆ‘è¿…é€Ÿä¿®æ­£ä½ç½®ã€‚",
              "èµ·é£›æ™‚ç•¥å¾®è½å¾Œï¼Œè¿½è¶•éç¨‹ä¸­ç”¢ç”Ÿæ°£æµå¹²æ“¾ï¼Œæˆ‘èª¿æ•´é£›è¡Œé«˜åº¦ç©©ä½éšŠå½¢ã€‚",
              "å½¼æ­¤çš„é€Ÿåº¦ä¸åŒæ­¥é€ æˆæ°£æµäº¤éŒ¯ï¼Œæˆ‘æ”¹è®Šè§’åº¦é¿å…é å¤ªè¿‘ã€‚"
            ],
            2: [
              "åˆ¤æ–·å¤±èª¤ä¸€åº¦æ¥è¿‘ä»–äººé£›è¡Œè»Œè·¡ï¼Œå¹²æ“¾æ°£æµè®“æˆ‘å¤±é€Ÿåé›¢éšŠå½¢ï¼Œå‹‰å¼·ç©©å®šå¾Œæ‰é‡è¿”ç·¨éšŠã€‚",
              "åœ¨ç·¨éšŠé£›è¡Œä¸­é€²å…¥æ°£æµä¸ç©©å®šå€åŸŸï¼Œç„¡æ³•ç²¾æº–ç¶­æŒä½ç½®ï¼Œè¢«æ¹æµæ²å‹•ï¼Œå·®é»æ’ä¸ŠéšŠå‹ã€‚",
              "å´é¢¨å¹²æ“¾å°è‡´æˆ‘éåº¦åé›¢ä½ç½®ï¼Œé€ æˆæ•´é«”ç·¨éšŠçŸ­æš«æ··äº‚ï¼Œåªèƒ½åŠªåŠ›ä¿®æ­£ã€‚"
            ],
            10: ["æˆ‘èª¤é—–ä»–äººæ¹æµç¯„åœï¼Œé£›é¼ è£åŠ‡çƒˆæ™ƒå‹•å¹¾è¿‘ç¿»è¦†ï¼Œæˆ‘é€£å¿™æ‹‰é–‹é™è½å‚˜ï¼Œæå‰çµæŸé€™æ®µé£›è¡Œã€‚é€™æ¬¡ä»»å‹™ï¼Œä»¥å¤±æ•—å‘Šçµ‚â€¦â€¦"]
          },

          C: { // é«˜ç©ºåŠ é€Ÿèˆ‡æ¸›é€Ÿ
            0: [
              "æˆ‘æ¨¡æ“¬äº†é«˜ç©ºåŠ é€Ÿèˆ‡æ¸›é€Ÿçš„å ´æ™¯ï¼Œå­¸ç¿’æ§åˆ¶å§¿æ…‹èˆ‡é€Ÿåº¦è®ŠåŒ–ã€‚",
              "é€™æ¬¡çš„é£›è¡Œé‡é»æ˜¯çµ‚ç«¯é€Ÿåº¦çš„æŒæ¡èˆ‡ç©ºæ°£é˜»åŠ›çš„åˆ©ç”¨ã€‚",
              "é€éèª¿æ•´è‚¢é«”å¼µåŠ›èˆ‡ä¿¯ä»°è§’ï¼Œæˆ‘æ›´ç†Ÿæ‚‰å¦‚ä½•åœ¨é«˜é€Ÿä¸­ä¿æŒç©©å®šã€‚"
            ],
            1: [
              "åœ¨æ¸›é€Ÿéç¨‹ä¸­å‚¾è§’ç¨å¾®éå¤§ï¼Œå·®é»å¤±å»ç©©å®šï¼Œå¹¸å¥½åŠæ™‚æ‹‰å›å§¿æ…‹ã€‚",
              "å˜—è©¦åŠ é€Ÿæ™‚ä¿¯è¡è§’åº¦ä¸å¤ é›†ä¸­ï¼Œé€Ÿåº¦æœªå¦‚é æœŸæå‡ï¼Œåªèƒ½èª¿æ•´è·¯ç·šé‡æ–°å˜—è©¦ã€‚",
              "åˆæœŸæ¸›é€Ÿæ“ä½œç•¥é¡¯éæ€¥ï¼Œé€ æˆè¼•å¾®æ–æ™ƒï¼Œä½†æˆ‘é¦¬ä¸Šæ”¾é¬†å±•ç¿¼ç©©ä½å¹³è¡¡ã€‚"
            ],
            2: [
              "æˆ‘é«˜ç©ºåŠ é€Ÿæ™‚æœªæŒæ¡å¥½ä¿¯è¡è§’ï¼Œé€Ÿåº¦è¶…å‡ºé æœŸï¼Œå¹¾ä¹æ’ä¸Šå²©å£ï¼Œè‡¨æ€¥è½‰å‘æ‰è„«å›°ã€‚",
              "åœ¨æ¸¬è©¦æ¥µé™æ¸›é€Ÿæ™‚èº«é«”é‡å¿ƒå‰å‚¾éåº¦ï¼Œå°è‡´æ»‘ç¿”ä¸­å¤±è¡¡ï¼Œåªèƒ½å‹‰å¼·å»¶é•·ä¸‹æ»‘è·é›¢ç©©ä½æ–¹å‘ã€‚",
              "é€£çºŒåŠ é€Ÿå¾Œåæ‡‰ä¸åŠï¼Œé£›é¼ è£ç”¢ç”Ÿä¸å°ç¨±æ°£æµï¼Œå°è‡´éœ‡ç›ªï¼Œé£›è¡ŒçµæŸå‰æ‰æ‹‰å›æ§åˆ¶æ¬Šã€‚"
            ],
            10: ["éåº¦åŠ é€Ÿé€ æˆå§¿æ…‹å´©æ½°ï¼Œæˆ‘å®Œå…¨ç„¡æ³•ç©©å®šæ©Ÿé«”ï¼Œåªèƒ½æœæ–·é–‹å‚˜çµ‚æ­¢é€™æ¬¡è¨“ç·´ã€‚é€™æ¬¡ä»»å‹™ï¼Œä»¥å¤±æ•—å‘Šçµ‚â€¦â€¦"]
          }
        };

        const trainingKey = state.answers.training;
        const trainingRisk = state.riskRecord[2];
        lines.push(randomFrom(trainingSentences[trainingKey][trainingRisk]));
        

        // ç¬¬äº”é¡Œï¼šè£å‚™
        const gearSentences = {
          A: { // å‚³çµ±å°¼é¾é£›é¼ è£
            0: [
              "æˆ‘ä½¿ç”¨çš„æ˜¯å‚³çµ±å°¼é¾é£›é¼ è£ï¼Œå„˜ç®¡ç°¡å–®ï¼Œå»èƒ½å¹«åŠ©æˆ‘å¼·åŒ–åŸºæœ¬é£›è¡ŒæŠ€å·§ã€‚",
              "å‚³çµ±å°¼é¾é£›é¼ è£è¦æ±‚æ¥µé«˜çš„èº«é«”æ§åˆ¶åŠ›ï¼Œæ˜¯ç£¨ç·´åŸºç¤çš„æœ€ä½³é¸æ“‡ã€‚",
              "å°¼é¾é£›é¼ è£è®“æˆ‘é‡æ–°é«”æœƒé¢¨çš„æµå‹•èˆ‡èº«é«”çš„é…åˆã€‚"
            ],
            1: [
              "å°¼é¾è£ç•¥æœ‰é¬†å¼›ï¼Œé£›è¡Œæ™‚ç”¢ç”Ÿç´°å¾®æ™ƒå‹•ï¼Œæˆ‘é ç©©å®šå§¿æ…‹åŒ–è§£å¹²æ“¾ã€‚",
              "å°¼é¾è£å¼µåŠ›ç•¥ä¸å‡ï¼Œå°è‡´ç¿¼é¢ç•¥é¡¯ä¸ç©©ï¼Œå¹¸å¥½æˆ‘å³æ™‚é‡æ–°å±•é–‹å‹•ä½œä¿®æ­£ã€‚",
              "èµ·è·³æ™‚å°¼é¾è£ç•¥æ…¢å……æ°£ï¼Œä½¿æˆ‘ä¸‹é™ç¨å¿«ï¼Œä½†æˆ‘èª¿æ•´ä¿¯ä»°è§’åº¦ç©©ä½æ»‘ç¿”ç¯€å¥ã€‚"
            ],
            2: [
              "å°¼é¾è£åœ¨é£›è¡Œä¸­ç”¢ç”Ÿæ˜é¡¯å¸ƒé¢éœ‡å‹•ï¼Œå°è‡´æ»‘ç¿”è·¯ç·šåç§»ï¼Œæˆ‘åŠªåŠ›ä¿æŒå§¿å‹¢æ‰æœªå¤±æ§ã€‚",
              "å°¼é¾ç¿¼é¢åœ¨äº‚æµä¸‹å¤±å»å‰›æ€§ï¼Œä¸€åº¦æŠ˜ç–Šè®Šå½¢ï¼Œæˆ‘åªèƒ½å¼·è¡Œç©©ä½èº«é«”å§¿æ…‹å»¶é•·é£›è¡Œã€‚",
              "ç¿¼é¢åœ¨ä¸ç©©æ°£æµä¸­é¼“è„¹ä¸å‡ï¼Œå°è‡´æ–¹å‘æ¼‚ç§»ï¼Œæˆ‘åªèƒ½ä¸æ–·èª¿æ•´å§¿å‹¢ä¿®æ­£é£›è¡Œè·¯ç·šã€‚"
            ],
            10: ["å°¼é¾é£›é¼ è£åœ¨é«˜å£“äº‚æµä¸‹åŠ‡çƒˆéœ‡å‹•ï¼Œç¿¼é¢å±€éƒ¨å¤±æ•ˆï¼Œæˆ‘ç„¡æ³•ç©©å®šæ»‘ç¿”ï¼Œåªèƒ½ç·Šæ€¥é–‹å‚˜ä¸­æ­¢è¨“ç·´ã€‚é€™æ¬¡ä»»å‹™ï¼Œä»¥å¤±æ•—å‘Šçµ‚â€¦â€¦"]
          },

          B: { // ç¢³çº–ç¶­æ°£å®¤è£
            0: [
              "æˆ‘ç©¿ä¸Šç¢³çº–ç¶­æ°£å®¤é£›é¼ è£ï¼Œèµ·è·³å¾Œè¿…é€Ÿå……æ°£å±•ç¿¼ï¼Œè®“æˆ‘æ›´æ—©é€²å…¥ç©©å®šæ»‘ç¿”ç‹€æ…‹ã€‚",
              "é€™å¥—è£å‚™æä¾›æ¥µé«˜å‰›æ€§èˆ‡å‡åŠ›ï¼Œä½¿æˆ‘åœ¨é«˜é€Ÿé£›è¡Œä¸­ä¿æŒç©©å®šï¼Œå³ä½¿é‡ä¸Šäº‚æµä¹Ÿèƒ½å¾å®¹æ‡‰å°ã€‚",
              "æ°£å®¤è¨­è¨ˆèˆ‡ç¢³çº–ç¶­å…§è¥¯çš„çµåˆè®“é£›è¡Œæ›´ç²¾æº–ã€æ›´é«˜æ•ˆï¼Œæ˜¯æŒ‘æˆ°è¤‡é›œé£›è¡Œè·¯ç·šçš„æœ€ä½³é¸æ“‡ã€‚"
            ],
            1: [
              "æ°£å®¤å……æ°£ç•¥æ…¢ï¼ŒåˆæœŸç©©å®šæ€§ç¨å¼±ï¼Œæˆ‘ä¿æŒä½å§¿æ…‹ç·©æ…¢æ»‘ç¿”ç©©ä½å±€å‹¢ã€‚",
              "ç¢³çº–ç¶­çµæ§‹åœ¨è½‰å½æ™‚ç”¢ç”Ÿäº›è¨±å´å‘æ™ƒå‹•ï¼Œæˆ‘é‡æ–°èª¿æ•´å¼µåŠ›é †åˆ©ä¿®æ­£ã€‚",
              "ç¢³çº–ç¶­æ°£å®¤è£é›–ç©©å®šï¼Œä½†åœ¨æ¥è¿‘åœ°å½¢è®ŠåŒ–è™•æ™‚ç”¢ç”Ÿå°å¹…æ°£æµäº‚å‹•ï¼Œæˆ‘ç«‹å³æ‹‰é«˜ç¶­æŒå®‰å…¨è·é›¢ã€‚"
            ],
            2: [
              "æ°£å®¤å……æ°£ä¸å®Œå…¨å°è‡´ç¿¼é¢åè»Ÿï¼Œé£›è¡Œåé›¢é å®šè»Œè·¡ï¼Œæˆ‘é ç¸®è‚¢è½‰èº«æ€¥æ‹‰ä¿¯ä»°è§’æ‰ç©©ä½æ–¹å‘ã€‚",
              "åœ¨å´é¢¨èˆ‡æ¹æµä¸­è£å‚™é–‹å§‹æ™ƒå‹•åç§»ï¼Œæˆ‘é ç¸®è‚¢ä¸¦é€£çºŒä¿®æ­£å¼µåŠ›æ‰ç©©ä½æ»‘ç¿”è»Œè·¡ã€‚",
              "é«˜ç©ºè½‰å½æ™‚ç¢³çº–ç¶­æ°£å®¤è£å‰›æ€§ä¸è¶³ä»¥æ”¯æ’åŠ é€Ÿåº¦ï¼Œæˆ‘æ»‘å‡ºé å®šèˆªç·šï¼Œéšªäº›æ’ä¸Šéšœç¤™ç‰©ã€‚"
            ],
            10: ["æ°£å®¤åœ¨é£›è¡ŒåˆæœŸæœªèƒ½æˆåŠŸå……æ°£ï¼Œå°è‡´è£å‚™ç„¡æ³•å½¢æˆå®Œæ•´ç¿¼é¢ï¼Œåªèƒ½ç·Šæ€¥é–‹å‚˜çµæŸé£›è¡Œã€‚é€™æ¬¡ä»»å‹™ï¼Œä»¥å¤±æ•—å‘Šçµ‚â€¦â€¦"]
          }
        };

        const gearKey = state.answers.gear;
        const gearRisk = state.riskRecord[3];
        lines.push(randomFrom(gearSentences[gearKey][gearRisk]));
        
        if (!state.hasFatalRisk) {
          let endingSet = [];

          if (state.risk <= 2) {
            endingSet = [
              "æ•´è¶Ÿè¨“ç·´éç¨‹é›–ç„¶è‰±é›£ï¼Œä½†æˆ‘å¾ä¸­å­¸åˆ°äº†å¯¶è²´çš„é£›è¡ŒçŸ¥è­˜èˆ‡ç¶“é©—ã€‚é€™ä¸€åˆ‡éƒ½å°‡æˆç‚ºæˆ‘é€šå¾€é«˜ç©ºå¤¢æƒ³çš„åŸºçŸ³ã€‚",
              "é€™æ®µé£›è¡Œæ—…ç¨‹æ•™æœƒæˆ‘å°Šé‡é¢¨çš„åŠ›é‡ï¼Œä¹Ÿè®“æˆ‘æ›´ç†è§£è‡ªå·±åœ¨ç©ºä¸­çš„æ¯ä¸€å€‹é¸æ“‡ã€‚",
              "æ¯ä¸€æ¬¡é£›è¡Œéƒ½æ˜¯èˆ‡è‡ªç„¶å°è©±çš„æ©Ÿæœƒï¼Œè€Œä»Šå¤©çš„è¨“ç·´ï¼Œè®“æˆ‘æ›´åŠ å …å®šäº†è¿½å¤¢çš„æ±ºå¿ƒã€‚"
            ];
          } else if (state.risk <= 4) {
            endingSet = [
              "å„˜ç®¡éç¨‹ä¸­å‡ºç¾äº†äº›å°ç‹€æ³ï¼Œä½†æˆ‘æˆåŠŸå®Œæˆäº†è¨“ç·´ï¼Œä¹Ÿç²å¾—äº†çè²´çš„ç¶“é©—ã€‚",
              "å¹¾æ¬¡é©šéšªèˆ‡æŒ‘æˆ°è®“æˆ‘æ›´æˆç†Ÿï¼Œä¹Ÿæ›´åŠ æ•¬ç•é€™ç‰‡å¤©ç©ºã€‚",
              "è¨“ç·´éç¨‹æ¯”é æœŸæ›´æ›²æŠ˜ï¼Œä½†æˆ‘æŒºäº†éä¾†ï¼Œä¹Ÿæ›´æ‡‚å¾—é¢¨éšªç®¡ç†çš„é‡è¦æ€§ã€‚"
            ];
          } else if (state.risk <= 7) {
            endingSet = [
              "é€™æ¬¡é£›è¡Œå……æ»¿å›°é›£èˆ‡éšªè±¡ï¼Œä½†æˆ‘æ’éä¾†äº†ã€‚æ‰“ä¸æ•—æˆ‘çš„ï¼Œéƒ½å°‡ä½¿æˆ‘æ›´å¼·ã€‚",
              "æˆ‘ä¸€åº¦å¤±å»æ§åˆ¶ï¼Œä½†é è‘—è¨“ç·´èˆ‡ç¶“é©—ï¼Œæœ€çµ‚ä»å¹³å®‰è‘—é™¸ã€‚",
              "é€™æ¬¡è¨“ç·´è®“æˆ‘çœŸæ­£é«”æœƒåˆ°ï¼Œæ¥µé™èˆ‡ç”Ÿé‚„ä¹‹é–“çš„è·é›¢æœ‰å¤šè¿‘ã€‚"
            ];
          } else {
            // fallbackï¼ˆæ‡‰è©²ä¸æœƒé€²å…¥é€™é‚Šï¼‰
            endingSet = ["é€™è¶Ÿé£›è¡Œæ–¼æˆ‘è€Œè¨€å¤±æ•—äº†ï¼Œä½†ä¹Ÿè®“æˆ‘çœ‹æ¸…äº†è‡ªå·±æœ€éœ€è¦å­¸æœƒçš„ï¼Œæ˜¯è¬™éœèˆ‡æº–å‚™ã€‚"];
          }
					lines.push(randomFrom(endingSet));
        }


        // æ‰“å­—æ©Ÿæ•ˆæœ
        let index = 0
        function typeLine() {
        	const fatalIndex = state.riskRecord.findIndex(v => v === 10); // å…ˆåˆ¤æ–·æ˜¯å¦æœ‰è‡´å‘½é¢¨éšª
          let maxLine = lines.length; // é è¨­ç‚ºå…¨éƒ¨è¼¸å‡º          
          
					// ä¸­æ–·æ—¥èªŒè¼¸å‡ºï¼Œææ—©çµæŸ
          if (state.hasFatalRisk) {    
            maxLine = fatalIndex + 3;
          }
        
          if (index < maxLine) {         	
            outputEl.innerText += lines[index] + "\n";
            index++;
            setTimeout(typeLine, 1000);
          }         
        }
        typeLine();       
      }
      
      function randomFrom(array) {
        return array[Math.floor(Math.random() * array.length)];
      }
      window.addEventListener("load", () => {
        const dice = document.getElementById("dice3d");
        dice.style.transition = "transform 0.1s";
        dice.style.transform = "rotateX(90deg) rotateY(90deg)";
      });
      function showRiskNotice(riskValue, callback) {
        const container = document.getElementById("dice3d-container");
        const dice = document.getElementById("dice3d");
        container.classList.remove("hidden");
        container.style.opacity = "1";
        container.style.visibility = "visible";


        // ç¦ç”¨æ‰€æœ‰é¸é …æŒ‰éˆ•
        const optionButtons = document.querySelectorAll(".choice-btn, .option-button");
        optionButtons.forEach(btn => btn.disabled = true);

        // å°æ‡‰é¢¨éšªå€¼çš„è§’åº¦
        const rotations = {
          0: { x: 0,   y: 0 },
          1: { x: 0,   y: 90 },
          2: { x: 0,   y: -90 },
          10: { x: 0,  y: 180 }
        };

        // ğŸ² ä¸€å‡ºç¾å°±è½‰å‹•
        let randX = Math.floor(Math.random() * 360 + 720);
        let randY = Math.floor(Math.random() * 360 + 720);
        dice.style.transition = "transform 0.8s ease";
        dice.style.transform = `rotateX(${randX}deg) rotateY(${randY}deg)`;

        // åœé “å¾Œè½‰åˆ°æ­£ç¢ºè§’åº¦
        setTimeout(() => {
          const target = rotations[riskValue];
          let finalX = 360 * 4 + target.x;
          let finalY = 360 * 4 + target.y;
          dice.style.transition = "transform 1s ease-out";
          dice.style.transform = `rotateX(${finalX}deg) rotateY(${finalY}deg)`;
        }, 800);

        // é¡¯ç¤ºé¢¨éšªå€¼
        setTimeout(() => {
          container.classList.add("hidden");
          container.style.left = ""; // æ¸…ç©ºå¯èƒ½å¹²æ“¾ä½ç½®çš„ left

          const box = document.getElementById("risk-notice");
          box.textContent = `âš ï¸é¢¨éšªå€¼ +${riskValue}`;
          box.style.opacity = "1";

          setTimeout(() => {
            box.style.opacity = "0";
          }, 1000);

          setTimeout(() => {
            box.textContent = "";
            // âœ… è§£é–é¸é …ï¼ˆå¯é¸æ“‡æ˜¯å¦å–æ¶ˆé€™æ®µï¼‰
            optionButtons.forEach(btn => btn.disabled = false);
            callback();
          }, 1500);
        }, 2500);
      }
      
      function restartGame() {
        // éš±è—æ‰€æœ‰é é¢
        document.getElementById("question-screen").classList.add("hidden");
        document.getElementById("knowledge-screen").classList.add("hidden");
        document.getElementById("final-message-screen").classList.add("hidden");
        document.getElementById("output-screen").classList.add("hidden");

        // é¡¯ç¤ºé¦–é 
        document.getElementById("start-screen").classList.remove("hidden");

        // é‡ç½®ç‹€æ…‹
        state.step = 0;
        state.answers = {};
        state.fatal = false;
        state.journalParts = [];
        state.risk = 0;
        state.riskRecord = [];
        state.hasFatalRisk = false;

        // æ¸…ç©ºéª°å­
        const dice = document.getElementById("dice3d");
        dice.style.transform = "rotateX(0deg) rotateY(0deg)";

        // æ¸…ç©ºæ—¥èªŒè¼¸å‡º
        const output = document.getElementById("output");
        if (output) output.innerText = "";
      }

      
    </script>
  </body>
</html>

